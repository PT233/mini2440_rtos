


ARM Macro Assembler    Page 1 


    1 00000000                 AREA             OS_CPU_CODE, CODE, READONLY
    2 00000000                 ARM
    3 00000000                 CODE32
    4 00000000                 PRESERVE8
    5 00000000         
    6 00000000         ; ===================================================
    7 00000000         ; Export all global symbols
    8 00000000         ; ===================================================
    9 00000000                 EXPORT           OS_CPU_SR_Save
   10 00000000                 EXPORT           OS_CPU_SR_Restore
   11 00000000                 EXPORT           OSStartHighRdy
   12 00000000                 EXPORT           OSCtxSw
   13 00000000                 EXPORT           OSIntCtxSw
   14 00000000                 EXPORT           OSTickISR
   15 00000000         
   16 00000000         ; ===================================================
   17 00000000         ; Import external symbols (from uCOS-II core)
   18 00000000         ; ===================================================
   19 00000000                 IMPORT           OSTCBCur
   20 00000000                 IMPORT           OSTCBHighRdy
   21 00000000                 IMPORT           OSPrioCur
   22 00000000                 IMPORT           OSPrioHighRdy
   23 00000000                 IMPORT           OSIntNesting
   24 00000000                 IMPORT           OSRunning
   25 00000000                 IMPORT           OSTimeTick
   26 00000000                 IMPORT           OSIntEnter
   27 00000000                 IMPORT           OSIntExit
   28 00000000                 IMPORT           OSTaskSwHook
   29 00000000         
   30 00000000         ; ============================================
   31 00000000         ; S3C2440 Register Address EQU Definitions (ARMASM recog
                       nizable)
   32 00000000         ; ============================================
   33 00000000         
   34 00000000 48000000 
                       BWSCON  EQU              0x48000000
   35 00000000 48000004 
                       BANKCON0
                               EQU              0x48000004
   36 00000000 48000008 
                       BANKCON1
                               EQU              0x48000008
   37 00000000 4800000C 
                       BANKCON2
                               EQU              0x4800000C
   38 00000000 48000010 
                       BANKCON3
                               EQU              0x48000010
   39 00000000 48000014 
                       BANKCON4
                               EQU              0x48000014
   40 00000000 48000018 
                       BANKCON5
                               EQU              0x48000018
   41 00000000 4800001C 
                       BANKCON6
                               EQU              0x4800001C
   42 00000000 48000020 
                       BANKCON7



ARM Macro Assembler    Page 2 


                               EQU              0x48000020
   43 00000000         
   44 00000000 48000024 
                       REFRESH EQU              0x48000024
   45 00000000 48000028 
                       BANKSIZE
                               EQU              0x48000028
   46 00000000 4800002C 
                       MRSRB6  EQU              0x4800002C
   47 00000000 48000030 
                       MRSRB7  EQU              0x48000030
   48 00000000         
   49 00000000         ; CLOCK
   50 00000000 4C000000 
                       LOCKTIME
                               EQU              0x4C000000
   51 00000000 4C000004 
                       MPLLCON EQU              0x4C000004
   52 00000000 4C000008 
                       UPLLCON EQU              0x4C000008
   53 00000000 4C00000C 
                       CLKCON  EQU              0x4C00000C
   54 00000000 4C000010 
                       CLKSLOW EQU              0x4C000010
   55 00000000 4C000014 
                       CLKDIVN EQU              0x4C000014
   56 00000000         
   57 00000000         ; INTERRUPT
   58 00000000 4A000000 
                       SRCPND  EQU              0x4A000000
   59 00000000 4A000004 
                       INTMOD  EQU              0x4A000004
   60 00000000 4A000008 
                       INTMSK  EQU              0x4A000008
   61 00000000 4A00000C 
                       PRIORITY
                               EQU              0x4A00000C
   62 00000000 4A000010 
                       INTPND  EQU              0x4A000010
   63 00000000 4A000014 
                       INTOFFSET
                               EQU              0x4A000014
   64 00000000 4A000018 
                       SUBSRCPND
                               EQU              0x4A000018
   65 00000000 4A00001C 
                       INTSUBMSK
                               EQU              0x4A00001C
   66 00000000         
   67 00000000         ; IO PORT
   68 00000000 56000050 
                       GPFCON  EQU              0x56000050
   69 00000000 56000054 
                       GPFDAT  EQU              0x56000054
   70 00000000 56000014 
                       GPBDAT  EQU              0x56000014
   71 00000000         
   72 00000000         
   73 00000000         



ARM Macro Assembler    Page 3 


   74 00000000         ; ===================================================
   75 00000000         ; OS_CPU_SR_Save
   76 00000000         ; ===================================================
   77 00000000         OS_CPU_SR_Save
   78 00000000 E10F0000        MRS              r0, cpsr
   79 00000004 E38010C0        ORR              r1, r0, #0xC0
   80 00000008 E121F001        MSR              cpsr_c, r1
   81 0000000C E12FFF1E        BX               lr
   82 00000010         
   83 00000010         
   84 00000010         ; ===================================================
   85 00000010         ; OS_CPU_SR_Restore
   86 00000010         ; ===================================================
   87 00000010         OS_CPU_SR_Restore
   88 00000010 E121F000        MSR              cpsr_c, r0
   89 00000014 E12FFF1E        BX               lr
   90 00000018         
   91 00000018         
   92 00000018         ; ===================================================
   93 00000018         ; OSStartHighRdy
   94 00000018         ; ===================================================
   95 00000018         OSStartHighRdy
   96 00000018         
   97 00000018         ; OSRunning = 1
   98 00000018 E59F0118        LDR              r0, =OSRunning
   99 0000001C E3A01001        MOV              r1, #1
  100 00000020 E5C01000        STRB             r1, [r0]
  101 00000024         
  102 00000024         ; Load highest priority task stack
  103 00000024 E59F0110        LDR              r0, =OSTCBHighRdy
  104 00000028 E5900000        LDR              r0, [r0]
  105 0000002C E590D000        LDR              sp, [r0]
  106 00000030         
  107 00000030         ; Restore SPSR
  108 00000030 E8BD0002        LDMFD            sp!, {r1}
  109 00000034 E121F001        MSR              cpsr_c, r1
  110 00000038         
  111 00000038 E8BDDFFF        LDMFD            sp!, {r0-r12, lr, pc}
  112 0000003C         
  113 0000003C         
  114 0000003C         ; ===================================================
  115 0000003C         ; OSCtxSw (Task Context Switch)
  116 0000003C         ; ===================================================
  117 0000003C         OSCtxSw
  118 0000003C         
  119 0000003C E92D4000        STMFD            sp!, {lr}
  120 00000040 E92D4000        STMFD            sp!, {lr}
  121 00000044 E92D1FFF        STMFD            sp!, {r0-r12}
  122 00000048         
  123 00000048 E10F0000        MRS              r0, cpsr
  124 0000004C E92D0001        STMFD            sp!, {r0}
  125 00000050         
  126 00000050         ; Save current SP
  127 00000050 E59F00E8        LDR              r0, =OSTCBCur
  128 00000054 E5901000        LDR              r1, [r0]
  129 00000058 E581D000        STR              sp, [r1]
  130 0000005C         
  131 0000005C         ; Switch TCB
  132 0000005C E59F20D8        LDR              r2, =OSTCBHighRdy



ARM Macro Assembler    Page 4 


  133 00000060 E5923000        LDR              r3, [r2]
  134 00000064 E5803000        STR              r3, [r0]
  135 00000068         
  136 00000068         ; Switch priority variables
  137 00000068 E59F00D4        LDR              r0, =OSPrioCur
  138 0000006C E59F10D4        LDR              r1, =OSPrioHighRdy
  139 00000070 E5D12000        LDRB             r2, [r1]
  140 00000074 E5C02000        STRB             r2, [r0]
  141 00000078         
  142 00000078         ; Switch SP to new task
  143 00000078 E593D000        LDR              sp, [r3]
  144 0000007C         
  145 0000007C         ; Restore task CPSR
  146 0000007C E8BD0001        LDMFD            sp!, {r0}
  147 00000080 E121F000        MSR              cpsr_c, r0
  148 00000084         
  149 00000084 E8BD5FFF        LDMFD            sp!, {r0-r12, lr}
  150 00000088 E25EF000        SUBS             pc, lr, #0
  151 0000008C         
  152 0000008C         
  153 0000008C         ; ===================================================
  154 0000008C         ; OSIntCtxSw (Context Switch in Interrupt)
  155 0000008C         ; ===================================================
  156 0000008C         OSIntCtxSw
  157 0000008C         
  158 0000008C E59F00AC        LDR              r0, =OSTCBCur
  159 00000090 E59F10A4        LDR              r1, =OSTCBHighRdy
  160 00000094 E5912000        LDR              r2, [r1]
  161 00000098 E5802000        STR              r2, [r0]
  162 0000009C         
  163 0000009C E59F00A0        LDR              r0, =OSPrioCur
  164 000000A0 E59F10A0        LDR              r1, =OSPrioHighRdy
  165 000000A4 E5D12000        LDRB             r2, [r1]
  166 000000A8 E5C02000        STRB             r2, [r0]
  167 000000AC         
  168 000000AC E592D000        LDR              sp, [r2]
  169 000000B0         
  170 000000B0 E8BD0001        LDMFD            sp!, {r0}
  171 000000B4 E121F000        MSR              cpsr_c, r0
  172 000000B8         
  173 000000B8 E8BD5FFF        LDMFD            sp!, {r0-r12, lr}
  174 000000BC E25EF000        SUBS             pc, lr, #0
  175 000000C0         
  176 000000C0         
  177 000000C0         ; ===================================================
  178 000000C0         ; OSTickISR (System Clock Tick)
  179 000000C0         ; ===================================================
  180 000000C0         OSTickISR
  181 000000C0         
  182 000000C0 E24EE004        SUB              lr, lr, #4
  183 000000C4 E92D500F        STMFD            sp!, {r0-r3, r12, lr}
  184 000000C8         
  185 000000C8 E14F0000        MRS              r0, spsr
  186 000000CC E92D0001        STMFD            sp!, {r0}
  187 000000D0         
  188 000000D0 E28DD018        ADD              sp, sp, #(6*4)
  189 000000D4         
  190 000000D4 E321F0D3        MSR              cpsr_c, #(0x13 :OR: 0xC0)
  191 000000D8         



ARM Macro Assembler    Page 5 


  192 000000D8 E92D4000        STMFD            sp!, {lr}
  193 000000DC E92D4000        STMFD            sp!, {lr}
  194 000000E0 E92D1FFF        STMFD            sp!, {r0-r12}
  195 000000E4 E92D0001        STMFD            sp!, {r0}
  196 000000E8         
  197 000000E8         ; OSIntNesting++
  198 000000E8 E59F005C        LDR              r0, =OSIntNesting
  199 000000EC E5D01000        LDRB             r1, [r0]
  200 000000F0 E2811001        ADD              r1, r1, #1
  201 000000F4 E5C01000        STRB             r1, [r0]
  202 000000F8         
  203 000000F8 E3510001        CMP              r1, #1
  204 000000FC 1A000002        BNE              _int_nested
  205 00000100         
  206 00000100         ; Save task SP before interrupt
  207 00000100 E59F0038        LDR              r0, =OSTCBCur
  208 00000104 E5901000        LDR              r1, [r0]
  209 00000108 E581D000        STR              sp, [r1]
  210 0000010C         
  211 0000010C         _int_nested
  212 0000010C         
  213 0000010C         ; Clear interrupt flags
  214 0000010C E3A0044A        LDR              r0, =SRCPND
  215 00000110 E3A01901        LDR              r1, =(1<<14)
  216 00000114 E5801000        STR              r1, [r0]
  217 00000118         
  218 00000118 E59F0030        LDR              r0, =INTPND
  219 0000011C E5801000        STR              r1, [r0]
  220 00000120         
  221 00000120 EBFFFFFE        BL               OSTimeTick
  222 00000124 EBFFFFFE        BL               OSIntExit
  223 00000128         
  224 00000128         ; Restore SPSR
  225 00000128 E8BD0001        LDMFD            sp!, {r0}
  226 0000012C E16FF000        MSR              spsr_cxsf, r0
  227 00000130         
  228 00000130 E8BD5FFF        LDMFD            sp!, {r0-r12, lr}
  229 00000134 E25EF000        SUBS             pc, lr, #0
  230 00000138         
  231 00000138         
  232 00000138 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              4A000010         LTORG
  233 00000154                 END
Command Line: --debug --xref --diag_suppress=9931 --cpu=ARM920T --apcs=interwor
k --depend=.\objects\os_cpu_cs_keil.d -o.\objects\os_cpu_cs_keil.o -I.\drivers 
-I.\include -I.\kernel -I.\lib -I.\user -I".\arch copy" -IE:\Keil_v5\ARM\RV31\I
NC -IE:\Keil_v5\ARM\INC\Samsung --predefine="__UVISION_VERSION SETA 538" --list
=.\listings\os_cpu_cs_keil.lst "arch copy\os_cpu_cs_keil.S"



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

OSCtxSw 0000003C

Symbol: OSCtxSw
   Definitions
      At line 117 in file arch
   Uses
      At line 12 in file arch
Comment: OSCtxSw used once
OSIntCtxSw 0000008C

Symbol: OSIntCtxSw
   Definitions
      At line 156 in file arch
   Uses
      At line 13 in file arch
Comment: OSIntCtxSw used once
OSStartHighRdy 00000018

Symbol: OSStartHighRdy
   Definitions
      At line 95 in file arch
   Uses
      At line 11 in file arch
Comment: OSStartHighRdy used once
OSTickISR 000000C0

Symbol: OSTickISR
   Definitions
      At line 180 in file arch
   Uses
      At line 14 in file arch
Comment: OSTickISR used once
OS_CPU_CODE 00000000

Symbol: OS_CPU_CODE
   Definitions
      At line 1 in file arch
   Uses
      None
Comment: OS_CPU_CODE unused
OS_CPU_SR_Restore 00000010

Symbol: OS_CPU_SR_Restore
   Definitions
      At line 87 in file arch
   Uses
      At line 10 in file arch
Comment: OS_CPU_SR_Restore used once
OS_CPU_SR_Save 00000000

Symbol: OS_CPU_SR_Save
   Definitions
      At line 77 in file arch
   Uses
      At line 9 in file arch
Comment: OS_CPU_SR_Save used once
_int_nested 0000010C

Symbol: _int_nested



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 211 in file arch
   Uses
      At line 204 in file arch
Comment: _int_nested used once
8 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

BANKCON0 48000004

Symbol: BANKCON0
   Definitions
      At line 35 in file arch
   Uses
      None
Comment: BANKCON0 unused
BANKCON1 48000008

Symbol: BANKCON1
   Definitions
      At line 36 in file arch
   Uses
      None
Comment: BANKCON1 unused
BANKCON2 4800000C

Symbol: BANKCON2
   Definitions
      At line 37 in file arch
   Uses
      None
Comment: BANKCON2 unused
BANKCON3 48000010

Symbol: BANKCON3
   Definitions
      At line 38 in file arch
   Uses
      None
Comment: BANKCON3 unused
BANKCON4 48000014

Symbol: BANKCON4
   Definitions
      At line 39 in file arch
   Uses
      None
Comment: BANKCON4 unused
BANKCON5 48000018

Symbol: BANKCON5
   Definitions
      At line 40 in file arch
   Uses
      None
Comment: BANKCON5 unused
BANKCON6 4800001C

Symbol: BANKCON6
   Definitions
      At line 41 in file arch
   Uses
      None
Comment: BANKCON6 unused
BANKCON7 48000020

Symbol: BANKCON7



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

   Definitions
      At line 42 in file arch
   Uses
      None
Comment: BANKCON7 unused
BANKSIZE 48000028

Symbol: BANKSIZE
   Definitions
      At line 45 in file arch
   Uses
      None
Comment: BANKSIZE unused
BWSCON 48000000

Symbol: BWSCON
   Definitions
      At line 34 in file arch
   Uses
      None
Comment: BWSCON unused
CLKCON 4C00000C

Symbol: CLKCON
   Definitions
      At line 53 in file arch
   Uses
      None
Comment: CLKCON unused
CLKDIVN 4C000014

Symbol: CLKDIVN
   Definitions
      At line 55 in file arch
   Uses
      None
Comment: CLKDIVN unused
CLKSLOW 4C000010

Symbol: CLKSLOW
   Definitions
      At line 54 in file arch
   Uses
      None
Comment: CLKSLOW unused
GPBDAT 56000014

Symbol: GPBDAT
   Definitions
      At line 70 in file arch
   Uses
      None
Comment: GPBDAT unused
GPFCON 56000050

Symbol: GPFCON
   Definitions
      At line 68 in file arch
   Uses



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Absolute symbols

      None
Comment: GPFCON unused
GPFDAT 56000054

Symbol: GPFDAT
   Definitions
      At line 69 in file arch
   Uses
      None
Comment: GPFDAT unused
INTMOD 4A000004

Symbol: INTMOD
   Definitions
      At line 59 in file arch
   Uses
      None
Comment: INTMOD unused
INTMSK 4A000008

Symbol: INTMSK
   Definitions
      At line 60 in file arch
   Uses
      None
Comment: INTMSK unused
INTOFFSET 4A000014

Symbol: INTOFFSET
   Definitions
      At line 63 in file arch
   Uses
      None
Comment: INTOFFSET unused
INTPND 4A000010

Symbol: INTPND
   Definitions
      At line 62 in file arch
   Uses
      At line 218 in file arch
Comment: INTPND used once
INTSUBMSK 4A00001C

Symbol: INTSUBMSK
   Definitions
      At line 65 in file arch
   Uses
      None
Comment: INTSUBMSK unused
LOCKTIME 4C000000

Symbol: LOCKTIME
   Definitions
      At line 50 in file arch
   Uses
      None
Comment: LOCKTIME unused
MPLLCON 4C000004



ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Absolute symbols


Symbol: MPLLCON
   Definitions
      At line 51 in file arch
   Uses
      None
Comment: MPLLCON unused
MRSRB6 4800002C

Symbol: MRSRB6
   Definitions
      At line 46 in file arch
   Uses
      None
Comment: MRSRB6 unused
MRSRB7 48000030

Symbol: MRSRB7
   Definitions
      At line 47 in file arch
   Uses
      None
Comment: MRSRB7 unused
PRIORITY 4A00000C

Symbol: PRIORITY
   Definitions
      At line 61 in file arch
   Uses
      None
Comment: PRIORITY unused
REFRESH 48000024

Symbol: REFRESH
   Definitions
      At line 44 in file arch
   Uses
      None
Comment: REFRESH unused
SRCPND 4A000000

Symbol: SRCPND
   Definitions
      At line 58 in file arch
   Uses
      At line 214 in file arch
Comment: SRCPND used once
SUBSRCPND 4A000018

Symbol: SUBSRCPND
   Definitions
      At line 64 in file arch
   Uses
      None
Comment: SUBSRCPND unused
UPLLCON 4C000008

Symbol: UPLLCON
   Definitions



ARM Macro Assembler    Page 5 Alphabetic symbol ordering
Absolute symbols

      At line 52 in file arch
   Uses
      None
Comment: UPLLCON unused
30 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

OSIntEnter 00000000

Symbol: OSIntEnter
   Definitions
      At line 26 in file arch
   Uses
      None
Comment: OSIntEnter unused
OSIntExit 00000000

Symbol: OSIntExit
   Definitions
      At line 27 in file arch
   Uses
      At line 222 in file arch
Comment: OSIntExit used once
OSIntNesting 00000000

Symbol: OSIntNesting
   Definitions
      At line 23 in file arch
   Uses
      At line 198 in file arch
Comment: OSIntNesting used once
OSPrioCur 00000000

Symbol: OSPrioCur
   Definitions
      At line 21 in file arch
   Uses
      At line 137 in file arch
      At line 163 in file arch

OSPrioHighRdy 00000000

Symbol: OSPrioHighRdy
   Definitions
      At line 22 in file arch
   Uses
      At line 138 in file arch
      At line 164 in file arch

OSRunning 00000000

Symbol: OSRunning
   Definitions
      At line 24 in file arch
   Uses
      At line 98 in file arch
Comment: OSRunning used once
OSTCBCur 00000000

Symbol: OSTCBCur
   Definitions
      At line 19 in file arch
   Uses
      At line 127 in file arch
      At line 158 in file arch
      At line 207 in file arch



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
External symbols


OSTCBHighRdy 00000000

Symbol: OSTCBHighRdy
   Definitions
      At line 20 in file arch
   Uses
      At line 103 in file arch
      At line 132 in file arch
      At line 159 in file arch

OSTaskSwHook 00000000

Symbol: OSTaskSwHook
   Definitions
      At line 28 in file arch
   Uses
      None
Comment: OSTaskSwHook unused
OSTimeTick 00000000

Symbol: OSTimeTick
   Definitions
      At line 25 in file arch
   Uses
      At line 221 in file arch
Comment: OSTimeTick used once
10 symbols
381 symbols in table
