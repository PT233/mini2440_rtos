


ARM Macro Assembler    Page 1 


    1 00000000         ; Ensure there is a space/tab before 'AREA'
    2 00000000                 AREA             RESET, CODE, READONLY ; Section
                                                             name is RESET
    3 00000000                 ARM                          ; 32-bit ARM mode
    4 00000000                 CODE32
    5 00000000                 PRESERVE8                    ; 8-byte stack alig
                                                            nment
    6 00000000         
    7 00000000         ; ======================================================
                       ==
    8 00000000         ; NAND/NOR Boot + SDRAM Init + Vector Table
    9 00000000         ; Target: mini2440 (S3C2440)
   10 00000000         ; ======================================================
                       ==
   11 00000000         
   12 00000000                 EXPORT           _start
   13 00000000                 EXPORT           Reset_Handler
   14 00000000         
   15 00000000                 IMPORT           main
   16 00000000                 IMPORT           OSTickISR
   17 00000000         
   18 00000000         ; Symbols generated by linker for ZI (BSS) section
   19 00000000                 IMPORT           |Image$$RW_RAM1$$ZI$$Base|
   20 00000000                 IMPORT           |Image$$RW_RAM1$$ZI$$Limit|
   21 00000000         ; Symbols for RW (initialized data) copy from load to ex
                       ec
   22 00000000                 IMPORT           |Image$$RW_RAM1$$Base|
   23 00000000                 IMPORT           |Image$$RW_RAM1$$Length|
   24 00000000                 IMPORT           |Load$$RW_RAM1$$Base|
   25 00000000         
   26 00000000         ; ======================================================
                       ==
   27 00000000         ; Register Definitions
   28 00000000         ; ======================================================
                       ==
   29 00000000 53000000 
                       WTCON   EQU              0x53000000
   30 00000000 48000000 
                       BWSCON  EQU              0x48000000
   31 00000000 4800001C 
                       BANKCON6
                               EQU              0x4800001C
   32 00000000 48000024 
                       REFRESH EQU              0x48000024
   33 00000000 48000028 
                       BANKSIZE
                               EQU              0x48000028
   34 00000000 4800002C 
                       MRSRB6  EQU              0x4800002C
   35 00000000 4C000000 
                       LOCKTIME
                               EQU              0x4C000000
   36 00000000 4C000004 
                       MPLLCON EQU              0x4C000004
   37 00000000 4C000008 
                       UPLLCON EQU              0x4C000008
   38 00000000 4C00000C 
                       CLKCON  EQU              0x4C00000C
   39 00000000 4C000014 



ARM Macro Assembler    Page 2 


                       CLKDIVN EQU              0x4C000014
   40 00000000 4A000008 
                       INTMSK  EQU              0x4A000008
   41 00000000         
   42 00000000         ; ======================================================
                       ==
   43 00000000         ; Exception Vector Table
   44 00000000         ; ======================================================
                       ==
   45 00000000         _start
   46 00000000 EAFFFFFE        B                Reset_Handler
   47 00000004 EA000005        B                Undefined_Handler
   48 00000008 EA000005        B                SWI_Handler
   49 0000000C EA000005        B                Prefetch_Handler
   50 00000010 EA000005        B                Abort_Handler
   51 00000014 EAFFFFFE        B                .
   52 00000018 EA000005        B                IRQ_Handler
   53 0000001C EA000003        B                FIQ_Handler
   54 00000020         
   55 00000020         Undefined_Handler
   56 00000020 EAFFFFFE        B                Undefined_Handler
   57 00000024         SWI_Handler
   58 00000024 EAFFFFFE        B                SWI_Handler
   59 00000028         Prefetch_Handler
   60 00000028 EAFFFFFE        B                Prefetch_Handler
   61 0000002C         Abort_Handler
   62 0000002C EAFFFFFE        B                Abort_Handler
   63 00000030         FIQ_Handler
   64 00000030 EAFFFFFE        B                FIQ_Handler
   65 00000034         
   66 00000034         IRQ_Handler
   67 00000034 EAFFFFFE        B                OSTickISR
   68 00000038         
   69 00000038         ; ======================================================
                       ==
   70 00000038         ; Reset Handler
   71 00000038         ; ======================================================
                       ==
   72 00000038         Reset_Handler
   73 00000038         
   74 00000038         ; 1. Disable Watchdog Timer
   75 00000038 E3A00453        LDR              r0, =WTCON
   76 0000003C E3A01000        MOV              r1, #0
   77 00000040 E5801000        STR              r1, [r0]
   78 00000044         
   79 00000044         ; 2. Mask All Interrupts
   80 00000044 E59F0164        LDR              r0, =INTMSK
   81 00000048 E3E01000        LDR              r1, =0xFFFFFFFF
   82 0000004C E5801000        STR              r1, [r0]
   83 00000050         
   84 00000050         ; 3. Configure Clock (FCLK:400MHz, HCLK:100MHz, PCLK:50M
                       Hz)
   85 00000050 E3A00313        LDR              r0, =LOCKTIME
   86 00000054 E3E01000        LDR              r1, =0xFFFFFFFF
   87 00000058 E5801000        STR              r1, [r0]
   88 0000005C         
   89 0000005C E59F0150        LDR              r0, =CLKDIVN
   90 00000060 E3A01005        MOV              r1, #5
   91 00000064 E5801000        STR              r1, [r0]



ARM Macro Assembler    Page 3 


   92 00000068         
   93 00000068 E59F0148        LDR              r0, =UPLLCON
   94 0000006C E59F1148        LDR              r1, =((56<<12)+(2<<4)+2)
   95 00000070 E5801000        STR              r1, [r0]
   96 00000074         
   97 00000074 E1A00000        NOP
   98 00000078 E1A00000        NOP
   99 0000007C E1A00000        NOP
  100 00000080         
  101 00000080 E59F0138        LDR              r0, =MPLLCON
  102 00000084 E59F1138        LDR              r1, =((127<<12)+(2<<4)+1)
  103 00000088 E5801000        STR              r1, [r0]
  104 0000008C         
  105 0000008C         ; 4. Initialize External SDRAM Controller
  106 0000008C E3A00312        LDR              r0, =BWSCON
  107 00000090 E3A01422        LDR              r1, =0x22000000
  108 00000094 E5801000        STR              r1, [r0]
  109 00000098         
  110 00000098 E59F0128        LDR              r0, =BANKCON6
  111 0000009C E59F1128        LDR              r1, =0x18001
  112 000000A0 E5801000        STR              r1, [r0]
  113 000000A4         
  114 000000A4 E59F0124        LDR              r0, =BANKSIZE
  115 000000A8 E3A010B1        LDR              r1, =0xB1
  116 000000AC E5801000        STR              r1, [r0]
  117 000000B0         
  118 000000B0 E59F011C        LDR              r0, =REFRESH
  119 000000B4 E59F111C        LDR              r1, =0x8404F5
  120 000000B8 E5801000        STR              r1, [r0]
  121 000000BC         
  122 000000BC E59F0118        LDR              r0, =MRSRB6
  123 000000C0 E3A01020        LDR              r1, =0x20
  124 000000C4 E5801000        STR              r1, [r0]
  125 000000C8         
  126 000000C8         ; 5. Relocation: Copy image from 0x0 to SDRAM (0x3000000
                       0)
  127 000000C8 E1A0000F        MOV              r0, pc
  128 000000CC E3A01203        LDR              r1, =0x30000000
  129 000000D0 E1500001        CMP              r0, r1
  130 000000D4 2A000008        BHS              CodeInSDRAM
  131 000000D8         
  132 000000D8 E59F0100        LDR              r0, =_start
  133 000000DC E3A01203        LDR              r1, =0x30000000
  134 000000E0 E59F20FC        LDR              r2, =Image_End
  135 000000E4 E0422000        SUB              r2, r2, r0
  136 000000E8         
  137 000000E8         CopyLoop
  138 000000E8 E4903004        LDR              r3, [r0], #4
  139 000000EC E4813004        STR              r3, [r1], #4
  140 000000F0 E2522004        SUBS             r2, r2, #4
  141 000000F4 CAFFFFFB        BGT              CopyLoop
  142 000000F8         
  143 000000F8 E59FF0E8        LDR              pc, =CodeInSDRAM
  144 000000FC         
  145 000000FC         ; ======================================================
                       ==
  146 000000FC         ; Running in SDRAM
  147 000000FC         ; ======================================================
                       ==



ARM Macro Assembler    Page 4 


  148 000000FC         CodeInSDRAM
  149 000000FC         
  150 000000FC         ; 6. Copy initialized RW data from load region to SDRAM 
                       exec region
  151 000000FC E59F00E8        LDR              r0, =|Image$$RW_RAM1$$Base| ; d
                                                            estination (exec in
                                                             SDRAM)
  152 00000100 E59F10E8        LDR              r1, =|Load$$RW_RAM1$$Base| ; so
                                                            urce (load in ROM/F
                                                            lash)
  153 00000104 E59F20E8        LDR              r2, =|Image$$RW_RAM1$$Length| 
                                                            ; length in bytes
  154 00000108         CopyRW
  155 00000108 E3520000        CMP              r2, #0
  156 0000010C 0A000003        BEQ              CopyRWDone
  157 00000110 E4913004        LDR              r3, [r1], #4
  158 00000114 E4803004        STR              r3, [r0], #4
  159 00000118 E2422004        SUB              r2, r2, #4
  160 0000011C EAFFFFF9        B                CopyRW
  161 00000120         CopyRWDone
  162 00000120         
  163 00000120         ; 7. Manual Zero-Initialization of BSS (ZI) Section
  164 00000120 E59F00D0        LDR              r0, =|Image$$RW_RAM1$$ZI$$Base|
  165 00000124 E59F10D0        LDR              r1, =|Image$$RW_RAM1$$ZI$$Limit
|
  166 00000128 E3A02000        MOV              r2, #0
  167 0000012C         ZeroBSS
  168 0000012C E1500001        CMP              r0, r1
  169 00000130 34802004        STRCC            r2, [r0], #4
  170 00000134 3AFFFFFC        BCC              ZeroBSS
  171 00000138         
  172 00000138         ; 8. Set Stack Pointer for SVC Mode
  173 00000138 33FFFFF0 
                       SVCStack
                               EQU              0x33FFFFF0
  174 00000138 00000013 
                       SVCMODE EQU              0x13
  175 00000138 0000001F 
                       MODEMASK
                               EQU              0x1F
  176 00000138         
  177 00000138 E10F0000        MRS              r0, cpsr
  178 0000013C E3C0001F        BIC              r0, r0, #MODEMASK
  179 00000140 E3800013        ORR              r0, r0, #SVCMODE
  180 00000144 E121F000        MSR              cpsr_c, r0
  181 00000148 E59FD0B0        LDR              sp, =SVCStack
  182 0000014C         
  183 0000014C         ; 9. Install Exception Vector Table to Physical Address 
                       0x0
  184 0000014C E3A00000        LDR              r0, =0x00000000
  185 00000150 E59F10AC        LDR              r1, =0xE59FF018 ; Instruction: 
                                                            LDR PC, [PC, #24]
  186 00000154 E3A02008        MOV              r2, #8
  187 00000158         VecInst
  188 00000158 E4801004        STR              r1, [r0], #4
  189 0000015C E2522001        SUBS             r2, r2, #1
  190 00000160 CAFFFFFC        BGT              VecInst
  191 00000164         
  192 00000164 E3A00020        LDR              r0, =0x00000020



ARM Macro Assembler    Page 5 


  193 00000168 E24F1E17        ADR              r1, _start  ; Map to the entry 
                                                            in SDRAM
  194 0000016C E4801004        STR              r1, [r0], #4 ; Reset
  195 00000170 E59F1090        LDR              r1, =Undefined_Handler
  196 00000174 E4801004        STR              r1, [r0], #4
  197 00000178 E59F108C        LDR              r1, =SWI_Handler
  198 0000017C E4801004        STR              r1, [r0], #4
  199 00000180 E59F1088        LDR              r1, =Prefetch_Handler
  200 00000184 E4801004        STR              r1, [r0], #4
  201 00000188 E59F1084        LDR              r1, =Abort_Handler
  202 0000018C E4801004        STR              r1, [r0], #4
  203 00000190 E3A01000        MOV              r1, #0      ; Reserved
  204 00000194 E4801004        STR              r1, [r0], #4
  205 00000198 E59F1078        LDR              r1, =IRQ_Handler
  206 0000019C E4801004        STR              r1, [r0], #4
  207 000001A0 E59F1074        LDR              r1, =FIQ_Handler
  208 000001A4 E4801004        STR              r1, [r0], #4
  209 000001A8         
  210 000001A8         ; 10. Jump to C Main
  211 000001A8 EBFFFFFE        BL               main
  212 000001AC         
  213 000001AC         Stop
  214 000001AC EAFFFFFE        B                Stop
  215 000001B0         
  216 000001B0         Image_End
  217 000001B0                 END
              4A000008 
              4C000014 
              4C000008 
              00038022 
              4C000004 
              0007F021 
              4800001C 
              00018001 
              48000028 
              48000024 
              008404F5 
              4800002C 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              33FFFFF0 
              E59FF018 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
Command Line: --debug --xref --diag_suppress=9931 --cpu=ARM920T --depend=.\obje
cts\startup_keil.d -o.\objects\startup_keil.o -I.\drivers -I.\include -I.\kerne
l -I.\lib -I.\user -I.\archcopy -IE:\Keil_v5\ARM\RV31\INC -IE:\Keil_v5\ARM\INC\
Samsung --predefine="__UVISION_VERSION SETA 538" --list=.\listings\startup_keil
.lst archcopy\startup_keil.S



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

Abort_Handler 0000002C

Symbol: Abort_Handler
   Definitions
      At line 61 in file archcopy\startup_keil.S
   Uses
      At line 50 in file archcopy\startup_keil.S
      At line 62 in file archcopy\startup_keil.S
      At line 201 in file archcopy\startup_keil.S

CodeInSDRAM 000000FC

Symbol: CodeInSDRAM
   Definitions
      At line 148 in file archcopy\startup_keil.S
   Uses
      At line 130 in file archcopy\startup_keil.S
      At line 143 in file archcopy\startup_keil.S

CopyLoop 000000E8

Symbol: CopyLoop
   Definitions
      At line 137 in file archcopy\startup_keil.S
   Uses
      At line 141 in file archcopy\startup_keil.S
Comment: CopyLoop used once
CopyRW 00000108

Symbol: CopyRW
   Definitions
      At line 154 in file archcopy\startup_keil.S
   Uses
      At line 160 in file archcopy\startup_keil.S
Comment: CopyRW used once
CopyRWDone 00000120

Symbol: CopyRWDone
   Definitions
      At line 161 in file archcopy\startup_keil.S
   Uses
      At line 156 in file archcopy\startup_keil.S
Comment: CopyRWDone used once
FIQ_Handler 00000030

Symbol: FIQ_Handler
   Definitions
      At line 63 in file archcopy\startup_keil.S
   Uses
      At line 53 in file archcopy\startup_keil.S
      At line 64 in file archcopy\startup_keil.S
      At line 207 in file archcopy\startup_keil.S

IRQ_Handler 00000034

Symbol: IRQ_Handler
   Definitions
      At line 66 in file archcopy\startup_keil.S
   Uses



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

      At line 52 in file archcopy\startup_keil.S
      At line 205 in file archcopy\startup_keil.S

Image_End 000001B0

Symbol: Image_End
   Definitions
      At line 216 in file archcopy\startup_keil.S
   Uses
      At line 134 in file archcopy\startup_keil.S
Comment: Image_End used once
Prefetch_Handler 00000028

Symbol: Prefetch_Handler
   Definitions
      At line 59 in file archcopy\startup_keil.S
   Uses
      At line 49 in file archcopy\startup_keil.S
      At line 60 in file archcopy\startup_keil.S
      At line 199 in file archcopy\startup_keil.S

RESET 00000000

Symbol: RESET
   Definitions
      At line 2 in file archcopy\startup_keil.S
   Uses
      None
Comment: RESET unused
Reset_Handler 00000038

Symbol: Reset_Handler
   Definitions
      At line 72 in file archcopy\startup_keil.S
   Uses
      At line 13 in file archcopy\startup_keil.S
      At line 46 in file archcopy\startup_keil.S

SWI_Handler 00000024

Symbol: SWI_Handler
   Definitions
      At line 57 in file archcopy\startup_keil.S
   Uses
      At line 48 in file archcopy\startup_keil.S
      At line 58 in file archcopy\startup_keil.S
      At line 197 in file archcopy\startup_keil.S

Stop 000001AC

Symbol: Stop
   Definitions
      At line 213 in file archcopy\startup_keil.S
   Uses
      At line 214 in file archcopy\startup_keil.S
Comment: Stop used once
Undefined_Handler 00000020

Symbol: Undefined_Handler



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 55 in file archcopy\startup_keil.S
   Uses
      At line 47 in file archcopy\startup_keil.S
      At line 56 in file archcopy\startup_keil.S
      At line 195 in file archcopy\startup_keil.S

VecInst 00000158

Symbol: VecInst
   Definitions
      At line 187 in file archcopy\startup_keil.S
   Uses
      At line 190 in file archcopy\startup_keil.S
Comment: VecInst used once
ZeroBSS 0000012C

Symbol: ZeroBSS
   Definitions
      At line 167 in file archcopy\startup_keil.S
   Uses
      At line 170 in file archcopy\startup_keil.S
Comment: ZeroBSS used once
_start 00000000

Symbol: _start
   Definitions
      At line 45 in file archcopy\startup_keil.S
   Uses
      At line 12 in file archcopy\startup_keil.S
      At line 132 in file archcopy\startup_keil.S
      At line 193 in file archcopy\startup_keil.S

17 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

BANKCON6 4800001C

Symbol: BANKCON6
   Definitions
      At line 31 in file archcopy\startup_keil.S
   Uses
      At line 110 in file archcopy\startup_keil.S
Comment: BANKCON6 used once
BANKSIZE 48000028

Symbol: BANKSIZE
   Definitions
      At line 33 in file archcopy\startup_keil.S
   Uses
      At line 114 in file archcopy\startup_keil.S
Comment: BANKSIZE used once
BWSCON 48000000

Symbol: BWSCON
   Definitions
      At line 30 in file archcopy\startup_keil.S
   Uses
      At line 106 in file archcopy\startup_keil.S
Comment: BWSCON used once
CLKCON 4C00000C

Symbol: CLKCON
   Definitions
      At line 38 in file archcopy\startup_keil.S
   Uses
      None
Comment: CLKCON unused
CLKDIVN 4C000014

Symbol: CLKDIVN
   Definitions
      At line 39 in file archcopy\startup_keil.S
   Uses
      At line 89 in file archcopy\startup_keil.S
Comment: CLKDIVN used once
INTMSK 4A000008

Symbol: INTMSK
   Definitions
      At line 40 in file archcopy\startup_keil.S
   Uses
      At line 80 in file archcopy\startup_keil.S
Comment: INTMSK used once
LOCKTIME 4C000000

Symbol: LOCKTIME
   Definitions
      At line 35 in file archcopy\startup_keil.S
   Uses
      At line 85 in file archcopy\startup_keil.S
Comment: LOCKTIME used once
MODEMASK 0000001F

Symbol: MODEMASK



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

   Definitions
      At line 175 in file archcopy\startup_keil.S
   Uses
      At line 178 in file archcopy\startup_keil.S
Comment: MODEMASK used once
MPLLCON 4C000004

Symbol: MPLLCON
   Definitions
      At line 36 in file archcopy\startup_keil.S
   Uses
      At line 101 in file archcopy\startup_keil.S
Comment: MPLLCON used once
MRSRB6 4800002C

Symbol: MRSRB6
   Definitions
      At line 34 in file archcopy\startup_keil.S
   Uses
      At line 122 in file archcopy\startup_keil.S
Comment: MRSRB6 used once
REFRESH 48000024

Symbol: REFRESH
   Definitions
      At line 32 in file archcopy\startup_keil.S
   Uses
      At line 118 in file archcopy\startup_keil.S
Comment: REFRESH used once
SVCMODE 00000013

Symbol: SVCMODE
   Definitions
      At line 174 in file archcopy\startup_keil.S
   Uses
      At line 179 in file archcopy\startup_keil.S
Comment: SVCMODE used once
SVCStack 33FFFFF0

Symbol: SVCStack
   Definitions
      At line 173 in file archcopy\startup_keil.S
   Uses
      At line 181 in file archcopy\startup_keil.S
Comment: SVCStack used once
UPLLCON 4C000008

Symbol: UPLLCON
   Definitions
      At line 37 in file archcopy\startup_keil.S
   Uses
      At line 93 in file archcopy\startup_keil.S
Comment: UPLLCON used once
WTCON 53000000

Symbol: WTCON
   Definitions
      At line 29 in file archcopy\startup_keil.S
   Uses



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Absolute symbols

      At line 75 in file archcopy\startup_keil.S
Comment: WTCON used once
15 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

Image$$RW_RAM1$$Base 00000000

Symbol: Image$$RW_RAM1$$Base
   Definitions
      At line 22 in file archcopy\startup_keil.S
   Uses
      At line 151 in file archcopy\startup_keil.S
Comment: Image$$RW_RAM1$$Base used once
Image$$RW_RAM1$$Length 00000000

Symbol: Image$$RW_RAM1$$Length
   Definitions
      At line 23 in file archcopy\startup_keil.S
   Uses
      At line 153 in file archcopy\startup_keil.S
Comment: Image$$RW_RAM1$$Length used once
Image$$RW_RAM1$$ZI$$Base 00000000

Symbol: Image$$RW_RAM1$$ZI$$Base
   Definitions
      At line 19 in file archcopy\startup_keil.S
   Uses
      At line 164 in file archcopy\startup_keil.S
Comment: Image$$RW_RAM1$$ZI$$Base used once
Image$$RW_RAM1$$ZI$$Limit 00000000

Symbol: Image$$RW_RAM1$$ZI$$Limit
   Definitions
      At line 20 in file archcopy\startup_keil.S
   Uses
      At line 165 in file archcopy\startup_keil.S
Comment: Image$$RW_RAM1$$ZI$$Limit used once
Load$$RW_RAM1$$Base 00000000

Symbol: Load$$RW_RAM1$$Base
   Definitions
      At line 24 in file archcopy\startup_keil.S
   Uses
      At line 152 in file archcopy\startup_keil.S
Comment: Load$$RW_RAM1$$Base used once
OSTickISR 00000000

Symbol: OSTickISR
   Definitions
      At line 16 in file archcopy\startup_keil.S
   Uses
      At line 67 in file archcopy\startup_keil.S
Comment: OSTickISR used once
main 00000000

Symbol: main
   Definitions
      At line 15 in file archcopy\startup_keil.S
   Uses
      At line 211 in file archcopy\startup_keil.S
Comment: main used once
7 symbols
372 symbols in table
